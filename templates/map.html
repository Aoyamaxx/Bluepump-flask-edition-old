<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Map the Pumps</title>
        <link rel="stylesheet" type="text/css" href="style.css">
        <link href="https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.css" rel="stylesheet">
        <script src="https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <link rel="icon" type="image/x-icon" href="images/favicon.ico">

        <style>
            body {
				margin: 0;
				padding: 0;
				display: grid;
				grid-template-rows: auto 1fr; /* Set the body grid layout to have two rows, one for the header and one for the content */
				min-height: 100vh;
			}
    
            #header {
				position: relative;
				height: auto; /* Change height to auto */
				background-color: #ffffff;
				width: 100%;
			}
    
			#content {
				flex: 1; /* This will make the content div take up the remaining vertical space */
			}

            #map {
	            height: 100%;
                width: 100%;
            }

            #footer {
                height: 0px;
                background-color: #ffffff;
                width: 100%;
                bottom: 0;
                left: 0;
              }
    
            .mapboxgl-popup {
                max-width: 400px;
                font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
            }

            .map-container {
				grid-row: 2; /* Set the map container to be in the second row of the grid */
				height: 100%;
				width: 100%;
			}
			
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
            }
        </style>
    </head>
    <body>
        <div id="header"></div>
		<div id="content">
        	<div class="map-container">
            	<div id="map"></div>
        	</div>
		</div>
        <script>
                    mapboxgl.accessToken = 'pk.eyJ1Ijoic2ViYXN0aWFuZ3JhZWZmIiwiYSI6ImNsMGR0NGw3cTAzMDAzZGxwZGl5bnR5Z2UifQ.U-eNkITMkqBtWTB532MbBA';
                    const map = new mapboxgl.Map({
                        container: 'map',
                        // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
                        style: 'mapbox://styles/sebastiangraeff/clex9r70g000401n0mrl5epdp',
                        center: [34.239,-0.010],
                        zoom: 10
                    });
    
                    map.on('load', () => {
                        map.addSource('places', {
                            // This GeoJSON contains features that include an "icon"
                            // property. The value of the "icon" property corresponds
                            // to an image in the Mapbox Streets style's sprite.
                            'type': 'geojson',
                            'data': {
                                'type': 'FeatureCollection',
                                'features': [
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                                '<strong>Angasa B Pump</strong><p><a href="projectthepump.html" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-02'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.276111, 0.096667]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Equator Special School Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-04'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.313767, 0.126172]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Kamlag Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.340278, 0.097222]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Kongongo Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-04'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.196000, 0.186990]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Kowet Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-02'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.347955, 0.139064]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Kuwuo Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-04'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.408056, 0.037778]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Lowle Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.410278, 0.147778]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Ndori Water Point Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.365278, 0.078611]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Nina Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-02'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.345449, 0.086107]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Nyadheho Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.178889, 0.188889]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Nyakongo Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.305122, 0.076083]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Nyalula Primary School Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-02'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.195278, 0.025556]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Salala Water Point Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.220833, 0.211944]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Sikinga Kondiek Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.169444, 0.173611]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Skange Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-02'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.314444, 0.139167]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Udamayi Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.088889, 0.074722]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Uhuak Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-02'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.269722, 0.114444]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Ulafu Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.317500, 0.071111]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Umaje Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-02'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.314399, 0.126167]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'properties': {
                                            'description':
                                            '<strong>Umuhula Pump</strong><p><a href="#" target="_blank" title="Opens in a new window">Learn more about pumps in Siaya County</a></p>',
                                            'icon': 'PumpSVG-03'
                                        },
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [34.202778, 0.231389]
                                        }
                                    },
                                ]
                            }
                        });
                        // Add a layer showing the places.
                        map.addLayer({
                            'id': 'places',
                            'type': 'symbol',
                            'source': 'places',
                            'layout': {
                                'icon-image': ['get', 'icon'],
                                'icon-allow-overlap': true,
                                'icon-size':  [
                                    'interpolate',
                                    // Set the exponential rate of change to 1.5
                                    ['exponential', 1.5],
                                    ['zoom'],
                                    // When zoom is 10, icon will be 50% size.
                                    10,
                                    0.5,
                                    // When zoom is 22, icon will be 10% size.
                                    22,
                                    0.1
                                ],
                            }
                        });
    
                        // When a click event occurs on a feature in the places layer, open a popup at the
                        // location of the feature, with description HTML from its properties.
                        map.on('click', 'places', (e) => {
                            // Copy coordinates array.
                            const coordinates = e.features[0].geometry.coordinates.slice();
                            const description = e.features[0].properties.description;
    
                            // Ensure that if the map is zoomed out such that multiple
                            // copies of the feature are visible, the popup appears
                            // over the copy being pointed to.
                            while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                                coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
                            }
    
                            new mapboxgl.Popup()
                                .setLngLat(coordinates)
                                .setHTML(description)
                                .addTo(map);
                        });
    
                        // Change the cursor to a pointer when the mouse is over the places layer.
                        map.on('mouseenter', 'places', () => {
                            map.getCanvas().style.cursor = 'pointer';
                        });
    
                        // Change it back to a pointer when it leaves.
                        map.on('mouseleave', 'places', () => {
                            map.getCanvas().style.cursor = '';
                        });
                    });
        </script>
        <div id="footer"></div>
        <script src="loadHeaderFooter.js"></script>
    </body>
</html>